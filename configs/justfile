# Unified Task Runner for Multi-Language Development
# Using just - vendor solution for command running

# Default environment setup
default: setup-dev

# Environment activation commands
setup-dev: mise-setup pixi-setup java-setup

# Tool version management
mise-setup:
    #!/usr/bin/env bash
    echo "ğŸ”§ Setting up tool versions with mise..."
    mise install
    mise use python@3.14.2
    mise use node@25.2.1
    mise use java@21.0.5+11
    mise use rust@1.92.0
    echo "âœ… Tool versions configured"

# Python/FEA environment
pixi-setup:
    #!/usr/bin/env bash
    echo "ğŸ Setting up Python FEA environment..."
    pixi install
    pixi run start
    echo "âœ… FEA environment ready"

# Java environment
java-setup:
    #!/usr/bin/env bash
    echo "â˜• Setting up Java environment..."
    cd java-enterprise-golden-path && ./mvnw --version
    echo "âœ… Java environment ready"

# Development workflows
dev-fea: mise-setup pixi-setup
    #!/usr/bin/env bash
    echo "ğŸ”¬ Starting FEA development environment..."
    pixi run fea

dev-ros: mise-setup
    #!/usr/bin/env bash
    echo "ğŸ¤– Starting ROS2 development environment..."
    cd pixi-ros2 && pixi install && pixi run setup-dev

dev-node: mise-setup
    #!/usr/bin/env bash
    echo "âš›ï¸ Starting Node.js development environment..."
    cd pixi-node && pixi install && pixi run setup

dev-java: mise-setup java-setup
    #!/usr/bin/env bash
    echo "ğŸ¢ Starting Java enterprise development..."
    cd java-enterprise-golden-path && ./mvnw clean compile

# Quality checks
quality: lint test

lint:
    #!/usr/bin/env bash
    echo "ğŸ” Running linters..."
    pixi run lint
    cd pixi-node && pixi run lint
    cd java-enterprise-golden-path && ./mvnw spotless:check
    echo "âœ… Linting complete"

test:
    #!/usr/bin/env bash
    echo "ğŸ§ª Running tests..."
    pixi run test
    cd pixi-node && pixi run test
    cd java-enterprise-golden-path && ./mvnw test
    echo "âœ… Testing complete"

# Build commands
build:
    #!/usr/bin/env bash
    echo "ğŸ”¨ Building all projects..."
    pixi run build
    cd pixi-node && pixi run build
    cd java-enterprise-golden-path && ./mvnw clean package -DskipTests
    echo "âœ… Build complete"

# Clean commands
clean:
    #!/usr/bin/env bash
    echo "ğŸ§¹ Cleaning all environments..."
    pixi run clean
    cd pixi-node && pixi run clean
    cd java-enterprise-golden-path && ./mvnw clean
    rm -rf target/
    echo "âœ… Cleanup complete"

# CI/CD simulation
ci: quality build
    #!/usr/bin/env bash
    echo "ğŸš€ Running CI pipeline..."
    echo "âœ… CI pipeline complete"

# Environment information
info:
    #!/usr/bin/env bash
    echo "ğŸ“Š Environment Information:"
    echo "=========================="
    mise --version
    echo ""
    pixi --version
    echo ""
    java --version
    echo ""
    node --version
    echo ""
    python --version
    echo ""
    rustc --version

# Help
help:
    #!/usr/bin/env bash
    echo "ğŸ¯ Unified Development Environment"
    echo "=================================="
    echo ""
    echo "Available commands:"
    echo "  setup-dev      - Setup all development environments"
    echo "  dev-fea        - Start FEA development"
    echo "  dev-ros        - Start ROS2 development"
    echo "  dev-node       - Start Node.js development"
    echo "  dev-java       - Start Java enterprise development"
    echo "  quality        - Run all quality checks"
    echo "  build          - Build all projects"
    echo "  clean          - Clean all environments"
    echo "  ci             - Run CI pipeline"
    echo "  info           - Show environment information"
    echo ""
    echo "Use 'just <command>' to run any command"
# AGI Automation Commands
agi-start: setup-dev
    #!/usr/bin/env bash
    echo "ğŸ¤– Starting AGI Environment..."
    ./scripts/start-agi-environment.sh

agi-stop:
    #!/usr/bin/env bash
    echo "ğŸ›‘ Stopping AGI Environment..."
    pkill -f "agi-orchestrator.py" || echo "AGI orchestrator not running"

agi-status:
    #!/usr/bin/env bash
    echo "ğŸ“Š AGI Environment Status:"
    echo "=========================="
    pgrep -f "agi-orchestrator.py" && echo "âœ… AGI orchestrator running" || echo "âŒ AGI orchestrator not running"
    ./scripts/test-api-connectivity.sh

agi-task task:
    #!/usr/bin/env bash
    echo "ğŸ¯ Running AGI task: {{task}}"
    python3 scripts/agi/agi-orchestrator.py "{{task}"

# Comprehensive system validation
validate-all: validate-setup test-connectivity
    #!/usr/bin/env bash
    echo "ğŸ” Running comprehensive system validation..."
    ./scripts/validate-environments.sh
    ./scripts/test-api-connectivity.sh
    echo "âœ… System validation complete"

# Environment connectivity tests
test-connectivity:
    #!/usr/bin/env bash
    echo "ğŸ”— Testing system connectivity..."
    ./scripts/test-api-connectivity.sh
